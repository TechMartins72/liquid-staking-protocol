module Admin {
    import CompactStandardLibrary;
    import GlobalStatesAndWitnesses;

    /** ADMIN FUNCTIONALITIES */
    /** Delegates protocol funds to third party  */
    export circuit delegate(): Boolean{
        const userPk = ownPublicKey().bytes;
        assert (userPk == superAdmin || admins.member(userPk), "Unauthorized to delegate protocol asset");
        const delegationAmt = protocolTVL.value; //(TESTNING ONLY)
        send(protocolTVL, right<ZswapCoinPublicKey, ContractAddress>(
            ContractAddress {
                bytes: delegationContractAddress
            }
        ), protocolTVL.value);
        stakePoolStatus = StakePoolStatus.delegated; 
        const isDelegated = disclose(call_backend_for_delegation(delegationAmt, kernel.self().bytes)); //(TESTNING ONLY)
        assert (isDelegated, "Failed to delegated protocol TVL"); //(TESTNING ONLY)
        return isDelegated;
    }

    /** Update admin access */
    export circuit addNewAdmin(adminCpk: Bytes<32>): [] {
        assert (ownPublicKey().bytes == superAdmin, "Unauthorized to add new admin");

        admins.insert(disclose(adminCpk));
    }

    export circuit setTokenColor(): []{
        const userPk = ownPublicKey().bytes;
        assert ( userPk == superAdmin || admins.member(userPk), "Unauthorized to add new admin");
        /** Construct the coin color minted to each user 
        * Depend on the domain seperator specified
        */
        stAssetCoinColor = tokenType(stAssetDomainSeparator, kernel.self());
    }

    export circuit removeNewAdmin(adminCpk: Bytes<32>): [] {
        assert (ownPublicKey().bytes == superAdmin, "Unauthorized to add new admin");

        admins.remove(disclose(adminCpk));
    }

}